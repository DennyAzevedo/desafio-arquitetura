# Cash Flow System â€” Arquitetura, MVP e VisÃ£o Ideal

Este projeto implementa uma arquitetura moderna, escalÃ¡vel e resiliente para o problema de **controle de lanÃ§amentos financeiros** e **consolidaÃ§Ã£o diÃ¡ria de saldo**.  
A soluÃ§Ã£o foi estruturada com base em princÃ­pios de _DDD_, _SOLID_, _Clean Architecture_, _MicrosserviÃ§os_,
_resiliÃªncia_, _observabilidade_ e _seguranÃ§a_, considerando:

- prazo de entrega (MVP funcional e realista);
- visÃ£o arquitetural completa (Ideal).

---

## ğŸ“Œ 1. Objetivo do Sistema

O sistema permite:

- Registrar lanÃ§amentos de **crÃ©dito** e **dÃ©bito** diariamente.
- Consolidar automaticamente o saldo diÃ¡rio.
- Expor consultas rÃ¡pidas para que o usuÃ¡rio (comerciante) acompanhe seu fluxo de caixa.

---

## ğŸš€ 2. Arquitetura Geral

A arquitetura foi modelada em duas versÃµes:

---

### ğŸ”µ **2.1 MVP (Minimum Viable Product)**

O MVP Ã© focado no essencial, garantindo:

- funcionalidade ponta a ponta,
- resiliÃªncia via mensageria,
- escalabilidade horizontal,
- documentaÃ§Ã£o completa.

#### ğŸ”§ Tecnologias do MVP

| Camada | Tecnologia |
|--------|------------|
| Linguagem | C# / .NET 8 |
| API Services | ASP.NET Core |
| Mensageria | RabbitMQ |
| Banco Write | PostgreSQL |
| Banco Read | PostgreSQL |
| MigraÃ§Ã£o de DB | Liquibase (changelog bÃ¡sico) |
| Observabilidade | Serilog |
| ContainerizaÃ§Ã£o | Docker Compose |
| Testes | xUnit |

#### ğŸ› ServiÃ§os no MVP

- **Transaction Service**  
  Recebe lanÃ§amentos, grava no banco e adiciona eventos no Outbox.

- **Outbox Dispatcher Worker**  
  Publica eventos `TransactionCreated` no RabbitMQ de forma resiliente.

- **Consolidation Service**  
  Consome eventos, atualiza o modelo de leitura e expÃµe consultas de saldo diÃ¡rio.

---

### ğŸ”µ **2.2 Arquitetura Ideal (VisÃ£o Alvo)**

#### ğŸŒ FrontEnd (Ideal)

- AplicaÃ§Ã£o Web (React/Angular/Vue/Blazor)
- AutenticaÃ§Ã£o via **OIDC**
- ComunicaÃ§Ã£o apenas com o **API Gateway**

#### ğŸ” SeguranÃ§a

- OIDC + JWT assinados
- OAuth2 Authorization Code Flow

#### ğŸ”‘ GestÃ£o de Segredos

- **Vault** (Hashicorp)

#### ğŸ“Š Observabilidade

- OpenTelemetry, Prometheus, Grafana, Loki

#### ğŸ•¸ Mensageria Ideal

- Kafka

#### âš¡ Escalabilidade

- Kubernetes

---

## ğŸ—‚ï¸ 3. Diagramas C4

Os diagramas estÃ£o na pasta:

/diagramas/

- Context
- Containers (MVP e Ideal)
- Componentes (MVP e Ideal)

---

## ğŸ—ï¸ 4. Estrutura dos Projetos

```bash
/src
  /TransactionService
  /ConsolidationService
/docs
  /diagramas
  /adr
  /imagens
/database
  /transaction
  /consolidation
/deploy
```

---

## âš™ï¸ 5. Como Executar o MVP Localmente

### 5.1 Subir a infraestrutura

```bash
docker compose up -d
```

### 5.2 Endpoints

| ServiÃ§o | URL |
|---------|------|
| Transaction API | `http://localhost:5001/swagger` |
| Consolidation API | `http://localhost:5002/swagger` |
| RabbitMQ UI | `http://localhost:15672` |

---

## ğŸ§© 6. DecisÃµes Arquiteturais (ADRs)

LocalizaÃ§Ã£o:

/docs/adr/

---

## ğŸ›£ï¸ 7. Roadmap de EvoluÃ§Ã£o

### ğŸŸ¢ MVP

- Transaction Service
- Consolidation Service
- RabbitMQ
- Outbox
- Liquibase inicial
- Read Model diÃ¡rio
- Testes essenciais

### ğŸ”µ Ideal

- API Gateway
- FrontEnd SPA
- OIDC + OAuth2
- Kafka
- Observabilidade completa
- Vault
- Redis Cache
- Kubernetes

---

## âœ”ï¸ 8. ConclusÃ£o

SoluÃ§Ã£o moderna, escalÃ¡vel e aderente ao desafio tÃ©cnico, equilibrando o que Ã© possÃ­vel entregar no prazo com uma visÃ£o arquitetural robusta de longo prazo.
